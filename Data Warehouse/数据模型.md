

# 为什么要数仓建模

建设高效的数据模型和体系，将数据有序、有结构地分类组织和存储，避免重复建设和数据不一致性，保证数据的规范性。以便在性能、成本、效率和质量之间取得最佳平衡。


# 数据处理方式

* 联机事务处理OLTP（on-line transaction processing）。OLTP是传统的关系型数据库的主要应用，主要是基本的、日常的事务处理，例如银行交易。OLTP 系统强调数据库内存效率，强调内存各种指标的命令率，强调绑定变量，强调并发操作；

* 联机分析处理OLAP（On-Line Analytical Processing）。OLAP是数据仓库系统的主要应用，支持复杂的分析操作，侧重决策支持，并且提供直观易懂的查询结果。OLAP 系统则强调数据分析，强调SQL执行市场，强调磁盘I/O，强调分区等。

![image](https://github.com/Artemis-arch/Big_Data/assets/104710981/8dc86852-9bad-40da-aa43-5ef7b75f2e7f)

总的来说，OLTP强调数据库的内存效率，数据量小，DML多。OLAP强调数据分析，数据量大，DML少。

# 数据仓库建模方法论

## ER模型 （实体关系模型）

***定义：***
用实体关系（Entity Relationship, ER）模型描述企业业务，在范式理论上符合3NF。数据仓库中的 3NF与 OLTP 系统中的 3NF的区别在于，它是站在企业角度面向主题的抽象，而不是针对某个具体业务流程的实体对象关系的抽象。

***实现：***
采用 ER模型建设数据仓库模型的出发点是整合数据，将各个系统中的数据以整个企业角度按主题进行相似性组合和合并，并进行一致性处理，为数据分析决策服务，但是并不能直接用于分析决策。

***建模步骤：***

* 高层模型：一个高度抽象的模型，描述主要的主题以及主题间的关系，用于描述企业的业务总体概况。
* 中层模型：在高层模型的基础上，细化主题的数据项。
* 物理模型（也叫底层模型）：在中层模型的基础上，考虑物理存储，同时基于性能和平台特点进行物理属性的设计，也可能做一些表的合并、分区的设计等。


***缺点：***

在不太成熟、快速变化的业务面前，构建ER模型的风险非常大，不太适合去构建ER模型。

## 维度模型

***定义：***
维度建模从分析决策的需求出发构建模型，为分析需求服务，因此它重点关注用户如何更快速地完成需求分析，同时具有较好的大规模复杂查询的响应性能。其典型的代表是星形模型，以及在一些特殊场景下使用的雪花模型。

***步骤：***

* 选择需要进行分析决策的业务过程。业务过程可以是单个业务事件，比如交易的支付、退款等；也可以是某个事件的状态，比如当前的账户余额等；还可以是一系列相关业务事件组成的业务流程，具体需要看我们分析的是某些事件发生情况，还是当前状态，或是事件流转效率。
* 选择粒度。在事件分析中，我们要预判所有分析需要细分的程度，从而决定选择的粒度。粒度是维度的一个组合。
* 识别维表。选择好粒度之后，就需要基于此粒度设计维表，包括维度属性，用于分析时进行分组和筛选。
* 选择事实。确定分析需要衡量的指标。

## Data Vault模型

***定义：***
它是 ER模型的衍生，其设计的出发点也是为了实现数据的整合，但不能直接用于数据分析决策。它强调建立一个可审计的基础数据层，也就是强调数据的历史性、可追溯性和原子性，而不要求对数据进行过度的一致性处理和整合；同时它基于主题概念将企业数据进行结构化组织，并引入了更进一步的范式处理来优化模型，以应对游、系统变更的扩展性。

## Anchor模型

***定义：***
一个高度可扩展的模型，其核心思想是所有的扩展只是添加而不是修改

# 建模方法论

从业务架构设计到模型设计，从数据研发到数据服务，做到数据可管理、可追溯、可规避重复建设

以下见《阿里巴巴大数据之路》第9章
